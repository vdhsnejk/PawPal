@page "/pets/{PetId:int}"
@layout PublicLayout
@inject NavigationManager Nav

<PageTitle>Pet Details</PageTitle>

<div class="container py-4">
    <button class="btn btn-link px-0 mb-3 text-decoration-none" @onclick="GoBack">
        <i class="bi bi-arrow-left me-2"></i> Back to Browse
    </button>

    @if (Pet is null)
    {
        <div class="alert alert-warning">
            Pet not found.
        </div>
    }
    else
    {
        <div class="row g-4">
            <div class="col-12 col-lg-6">
                <div class="card border-0 shadow-sm overflow-hidden">
                    <img src="@Pet.ImageUrl" style="width:100%; height:420px; object-fit:cover;" alt="Pet photo" />
                </div>
            </div>

            <div class="col-12 col-lg-6">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <h1 class="mb-1">@Pet.Name</h1>
                        <div class="text-muted">@Pet.Breed • @Pet.Age years • @Pet.Gender</div>
                    </div>

                    <span class="badge bg-success-subtle text-success border border-success-subtle px-3 py-2">
                        @Pet.Status
                    </span>
                </div>

                <div class="mt-3 d-flex flex-wrap gap-2">
                    <span class="badge text-bg-light border">@Pet.Species</span>
                    <span class="badge text-bg-light border">@Pet.Size</span>
                    <span class="badge text-bg-light border">@Pet.Temperament</span>
                </div>

                <hr class="my-4" />

                <h5>About @Pet.Name</h5>
                <p class="text-muted">@Pet.Description</p>

                <div class="card border-0 bg-light mt-4">
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="text-muted small">Medical Info</div>
                                <div class="fw-semibold">@Pet.MedicalInfo</div>
                            </div>
                            <div class="col-6">
                                <div class="text-muted small">Shelter</div>
                                <div class="fw-semibold">@Pet.ShelterName</div>
                            </div>
                            <div class="col-12">
                                <div class="text-muted small">Location</div>
                                <div class="fw-semibold">@Pet.ShelterAddress</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 d-grid gap-2">
                    <a class="btn btn-success btn-lg" href="@($"/apply/{Pet.Id}")">
                        Apply to Adopt
                    </a>
                    <div class="text-muted small text-center">
                        You’ll need an account to submit an application.
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@code {
    [Parameter] public int PetId { get; set; }

    private PetDetailsVm? Pet;

    private readonly List<PetDetailsVm> _pets = new()
    {
        new PetDetailsVm(1,"Milo","Dog","Mixed",2,"Medium","Male","Friendly","Available",
            "Milo is playful, loves walks, and enjoys cuddles after playtime.",
            "Vaccinated, dewormed",
            "Happy Tails Shelter",
            "123 Tampines Ave 1",
            "https://images.unsplash.com/photo-1548199973-03cce0bbc87b?auto=format&fit=crop&w=1400&q=80"),
        new PetDetailsVm(2,"Luna","Cat","Domestic Shorthair",3,"Small","Female","Calm","Available",
            "Luna is quiet and affectionate. Perfect for a calm home environment.",
            "Sterilised, vaccinated",
            "Paws & Care Shelter",
            "55 Bedok North Rd",
            "https://images.unsplash.com/photo-1518791841217-8f162f1e1131?auto=format&fit=crop&w=1400&q=80"),
        new PetDetailsVm(3,"Kaya","Dog","Shiba Inu",1,"Small","Female","Active","Available",
            "Kaya is energetic and curious. She’ll thrive with an active adopter.",
            "Vaccinated",
            "Westside Rescue",
            "8 Jurong West St 12",
            "https://images.unsplash.com/photo-1552053831-71594a27632d?auto=format&fit=crop&w=1400&q=80"),
    };

    protected override void OnParametersSet()
    {
        Pet = _pets.FirstOrDefault(p => p.Id == PetId);
    }

    private void GoBack()
    {
        Nav.NavigateTo("/pets");
    }

    private record PetDetailsVm(
        int Id,
        string Name,
        string Species,
        string Breed,
        int Age,
        string Size,
        string Gender,
        string Temperament,
        string Status,
        string Description,
        string MedicalInfo,
        string ShelterName,
        string ShelterAddress,
        string ImageUrl
    );
}
