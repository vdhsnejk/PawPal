@page "/pets/delete"
@using PawPal.Domain
@using PawPal.Repositories
@inject IPetRepository PetRepository
@inject NavigationManager NavigationManager

<h1>Delete Pet</h1>
<h3>Are you sure you want to delete this?</h3>

@if (pet != null)
{
    <div>
        <hr />
        <dl class="row">
            <dt class="col-sm-2">Name</dt>
            <dd class="col-sm-10">@pet.Name</dd>
            <dt class="col-sm-2">Breed</dt>
            <dd class="col-sm-10">@pet.Breed</dd>
        </dl>

        <EditForm Model="pet" OnValidSubmit="DeletePet">
            <button type="submit" class="btn btn-danger">Delete</button>
            <a href="/pets" class="btn btn-secondary">Cancel</a>
        </EditForm>
    </div>
}

@code {
    private Pet? pet;
    [SupplyParameterFromQuery] public int Id { get; set; }

    protected override async Task OnInitializedAsync() => pet = await PetRepository.GetPetByIdAsync(Id);

    private async Task DeletePet()
    {
        await PetRepository.DeletePetAsync(Id);
        NavigationManager.NavigateTo("/pets");
    }
}