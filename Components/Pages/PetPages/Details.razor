@page "/pets/details"
@using PawPal.Domain
@using PawPal.Repositories
@inject IPetRepository PetRepository
@inject NavigationManager NavigationManager

<PageTitle>Pet Details</PageTitle>

<h1>Details</h1>

<div>
    <h2>Pet Profile</h2>
    <hr />
    @if (pet is null)
    {
        <p><em>Loading...</em></p>
    }
    else
    {
        <div class="row">
            <div class="col-md-4">
                @if (!string.IsNullOrEmpty(pet.ImageUrl))
                {
                    <img src="@pet.ImageUrl" class="img-fluid rounded shadow" alt="@pet.Name" />
                }
                else
                {
                    <div class="alert alert-secondary">No Image Available</div>
                }
            </div>

            <div class="col-md-8">
                <dl class="row">
                    <dt class="col-sm-3">Name</dt>
                    <dd class="col-sm-9">@pet.Name</dd>

                    <dt class="col-sm-3">Breed</dt>
                    <dd class="col-sm-9">@pet.Breed</dd>

                    <dt class="col-sm-3">Age</dt>
                    <dd class="col-sm-9">@pet.Age years</dd>

                    <dt class="col-sm-3">Size</dt>
                    <dd class="col-sm-9">@pet.Size</dd>

                    <dt class="col-sm-3">Description</dt>
                    <dd class="col-sm-9">@pet.Description</dd>

                    <dt class="col-sm-3">Shelter</dt>
                    <dd class="col-sm-9">@(pet.Shelter?.Name ?? "Unknown")</dd>
                </dl>

                <div class="mt-4">
                    <a href="/appointments/create?petId=@pet.Id" class="btn btn-success btn-lg me-2">
                        <i class="bi bi-calendar-check"></i> Book Adoption Appointment
                    </a>

                    <a href="/pets" class="btn btn-outline-secondary btn-lg">Back to List</a>
                </div>

                <div class="mt-3">
                    <a href="/pets" class="btn btn-outline-secondary">Back to List</a>
                </div>
            </div>
        </div>
    }
</div>

@code {
    private Pet? pet;

    [SupplyParameterFromQuery]
    public int Id { get; set; }

    protected override async Task OnInitializedAsync()
    {
        pet = await PetRepository.GetPetByIdAsync(Id);

        if (pet is null)
        {
            NavigationManager.NavigateTo("notfound");
        }
    }
}